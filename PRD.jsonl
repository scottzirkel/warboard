{"id":"limits-001","category":"wargear-limits","phase":"phase-1","description":"Add maxModels field to loadout choice data structure","passes":true,"acceptance":["custodes.json has maxModels field on vexilla choice","maxModels: 1 limits vexilla to one model","Data structure documented in CLAUDE.md"],"dependencies":[]}
{"id":"limits-002","category":"wargear-limits","phase":"phase-1","description":"Add validation logic for maxModels in weapon count updates","passes":true,"acceptance":["updateWeaponCount enforces maxModels constraint","Cannot increment past maxModels limit","Validation works for all constrained options"],"dependencies":["limits-001"]}
{"id":"limits-003","category":"wargear-limits","phase":"phase-2","description":"Update UI to show maxModels limits and disable controls","passes":false,"acceptance":["Max limit indicator shown next to constrained options","Increment button disabled when limit reached","Tooltip explains the restriction"],"dependencies":["limits-002"]}
{"id":"limits-004","category":"wargear-limits","phase":"phase-2","description":"Add list validation for maxModels on save and play mode entry","passes":false,"acceptance":["Validation runs on list save","Validation runs before entering Play Mode","Clear error message shown if limits violated"],"dependencies":["limits-002"]}
{"id":"patterns-001","category":"wargear-patterns","phase":"phase-1","description":"Add pattern field to loadout options data structure","passes":true,"acceptance":["custodes.json loadout options have pattern field","pattern values: replacement or addition","Custodian Guard main-weapon is replacement, vexilla is addition"],"dependencies":[]}
{"id":"patterns-002","category":"wargear-patterns","phase":"phase-1","description":"Add paired field to choices for combined loadouts","passes":true,"acceptance":["Sentinel Blade + Shield choice has paired: true","Data structure supports grouping two items as one choice","Paired choices documented in CLAUDE.md"],"dependencies":["patterns-001"]}
{"id":"patterns-003","category":"wargear-patterns","phase":"phase-2","description":"Update weapon display logic for replacement vs addition patterns","passes":false,"acceptance":["Replacement pattern hides unselected weapons","Addition pattern shows equipped items alongside base weapons","getEquippedWeapons function handles both patterns"],"dependencies":["patterns-001"]}
{"id":"patterns-004","category":"wargear-patterns","phase":"phase-2","description":"Update UI labels to indicate pattern type","passes":false,"acceptance":["Replacement options show as dropdown with Replace with label","Addition options show as checkbox-style add controls","UI clearly distinguishes pattern types"],"dependencies":["patterns-003"]}
{"id":"patterns-005","category":"wargear-patterns","phase":"phase-2","description":"Handle paired loadouts equipping both items together","passes":false,"acceptance":["Selecting paired choice equips both items","Unselecting removes both items","Combined name shown in UI"],"dependencies":["patterns-002","patterns-003"]}
{"id":"abilities-001","category":"wargear-abilities","phase":"phase-1","description":"Add modifiers array to weapons that grant stat bonuses","passes":true,"acceptance":["Sentinel Blade weapon has modifiers array","Praesidium Shield +1W modifier added with source field","Modifier uses existing format: stat, operation, value, scope"],"dependencies":["patterns-002"]}
{"id":"abilities-002","category":"wargear-abilities","phase":"phase-2","description":"Add isWeaponEquipped helper function","passes":false,"acceptance":["Function checks if weapon is equipped based on loadoutGroup","Returns true for weapons without loadoutGroup","Works with weaponCounts state"],"dependencies":["patterns-003"]}
{"id":"abilities-003","category":"wargear-abilities","phase":"phase-2","description":"Update collectModifiers to include weapon modifiers","passes":false,"acceptance":["collectModifiers checks equipped weapons for modifiers","Weapon modifiers with model or unit scope are collected","Modifiers only apply when weapon is equipped"],"dependencies":["abilities-001","abilities-002"]}
{"id":"abilities-004","category":"wargear-abilities","phase":"phase-3","description":"Update stat display to show weapon modifier sources in tooltips","passes":false,"acceptance":["Tooltip shows Praesidium Shield as source of +1W","Multiple modifier sources listed if applicable","Clear formatting of modifier sources"],"dependencies":["abilities-003"]}
{"id":"abilities-005","category":"wargear-abilities","phase":"phase-3","description":"Add wargear abilities section to Quick Reference panel","passes":false,"acceptance":["Quick Reference shows wargear stat modifiers","Praesidium Shield: Bearer gains +1 Wound displayed","Section only shows if wargear abilities exist"],"dependencies":["abilities-003"]}
{"id":"leader-001","category":"leader-attachment","phase":"phase-1","description":"Add eligibleUnits array to leader abilities in data","passes":false,"acceptance":["Shield-Captain leader ability has eligibleUnits array","eligibleUnits contains custodian-guard and custodian-wardens","Blade Champion leader ability updated similarly"],"dependencies":[]}
{"id":"leader-002","category":"leader-attachment","phase":"phase-1","description":"Add attachedLeader field to list unit structure","passes":false,"acceptance":["addUnitToList includes attachedLeader: null","attachedLeader structure is { unitIndex: number } or null","Saved lists include attachedLeader field"],"dependencies":[]}
{"id":"leader-003","category":"leader-attachment","phase":"phase-2","description":"Add getAvailableLeaders function","passes":false,"acceptance":["Returns list of eligible unattached leaders for a unit","Filters based on leader eligibleUnits array","Excludes leaders already attached to other units"],"dependencies":["leader-001","leader-002"]}
{"id":"leader-004","category":"leader-attachment","phase":"phase-2","description":"Add attachLeader and detachLeader functions","passes":false,"acceptance":["attachLeader detaches leader from previous unit first","attachLeader sets attachedLeader on target unit","detachLeader sets attachedLeader to null"],"dependencies":["leader-003"]}
{"id":"leader-005","category":"leader-attachment","phase":"phase-2","description":"Update collectModifiers to include attached leader modifiers","passes":false,"acceptance":["Leader enhancement modifiers apply to attached unit","Modifiers removed when leader detached","Works with existing modifier system"],"dependencies":["leader-004"]}
{"id":"leader-006","category":"leader-attachment","phase":"phase-3","description":"Add leader attachment dropdown UI to unit cards","passes":false,"acceptance":["Dropdown shows available leaders for eligible units","Selecting leader calls attachLeader function","None option detaches current leader"],"dependencies":["leader-004"]}
{"id":"leader-007","category":"leader-attachment","phase":"phase-3","description":"Update unit display for units with attached leaders","passes":false,"acceptance":["Unit name shows combined format: Custodian Guard + Shield-Captain","Leader weapons shown in weapon list","Combined model count displayed"],"dependencies":["leader-006"]}
{"id":"leader-008","category":"leader-attachment","phase":"phase-3","description":"Hide attached leaders from main army list display","passes":false,"acceptance":["Attached leaders not shown as separate units in Play Mode","Build Mode still shows all units for editing","Visual indicator that leader is attached elsewhere"],"dependencies":["leader-007"]}
{"id":"leader-009","category":"leader-attachment","phase":"phase-3","description":"Add separate wound tracking for attached leaders","passes":false,"acceptance":["Leader wounds tracked separately from unit wounds","UI shows both unit and leader wound pools","Damage can be assigned to either"],"dependencies":["leader-007"]}
{"id":"leader-010","category":"leader-attachment","phase":"phase-4","description":"Add validation rules for leader attachment","passes":false,"acceptance":["Leader can only attach to one unit","Unit can only have one leader","Validation prevents invalid attachments"],"dependencies":["leader-004"]}
